{"version":3,"sources":["providers/utils.js","components/cityViewer/tooltip/tooltip.module.css","components/cityViewer/cityViewer.module.css","components/header/header.module.css","assets/Ground.png","assets/Grass.png","assets/Church.png","assets/Pravda.png","assets/milk_cooperation_small.png","assets/milk_cooperation.png","components/common/Modal.jsx","components/modals/LoadModal.jsx","components/header/Header.jsx","components/TilesLibrary.jsx","providers/TilesService.js","components/cityBuilder/CityBuilder.jsx","components/cityViewer/tooltip/Tooltip.jsx","components/cityViewer/CityViewer.jsx","components/TilesBuilder.jsx","App.js","index.js"],"names":["debouce","cb","delay","now","performance","lastCall","window","clearTimeout","lastTimerId","setTimeout","saveToHash","obj","location","hash","Buffer","from","JSON","stringify","toString","stateToB64","loadFromHash","maybeHash","data","cleanHash","str","parse","e","indexOf","split","pop","substr","module","exports","Context","React","createContext","ModalProvider","_ref","children","modalRef","useRef","context","setContext","useState","useEffect","current","createElement","className","Provider","value","ref","Modal","_ref2","onClose","props","modalNode","useContext","ReactDOM","createPortal","onClick","Object","assign","ev","stopPropagation","title","LoadModal","setOpen","onLoadHash","loadInputRef","style","width","maxWidth","type","Header","isEditMode","onEditHandler","isModalOpen","setIsModalOpen","header","options","arr","url","imgSrc1","imgSrc2","imgSrc3","imgSrc4","imgSrc6","imgSrc7","TilesLibrary","selectedTile","onSelect","map","i","key","concat","backgroundImage","constants","indexToTileXY","tileX","tileY","Math","floor","x","y","indexToPosition","gridSize","arguments","length","undefined","indexToViewPosition","offsetX","offsetY","left","top","createTiles","Array","fill","_","randomize","random","loadStateFromHash","baseGridSize","baseTiles","tiles","TilesView","onLeftClick","onRightClick","handleClick","target","hasAttribute","Number","getAttribute","getTileIdxFromBtnEvent","preventDefault","buttons","onMouseMove","tile","data-tile-idx","onMouseDown","Tooltip","tooltip","closeBtn","table","Fragment","CityViewer","selected","setSelected","closeHandler","tilesView","tileBtn","lastHash","TilesBuilder","setGridSize","setTiles","setSelectedTile","setIsEditMode","addEventListener","onHashChange","removeEventListener","updateHash","newHash","URL","newURL","handleLoadHash","doUpdate","newGridSize","newTiles","setTile","tileIdx","tileType","leftClick","rightClick","onGridSizeChange","newValue","updateGridSize","oldGridSize","oldTiles","save","Map","forEach","coords","set","newIdx","positionToIndex","onRandomize","onClear","clear","editHandler","prev","newSelection","CityBuilder","App","rootElement","document","getElementById","render"],"mappings":"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","file":"static/js/main.6901c9f5.chunk.js","sourcesContent":["export const stateToB64 = obj =>\r\n  Buffer.from(JSON.stringify(obj)).toString(\"base64\");\r\n\r\nexport const B64ToState = str => JSON.parse(Buffer.from(str, \"base64\"));\r\n\r\nexport const debouce = (cb, delay) => {\r\n  const now = performance.now();\r\n  if (debouce.lastCall && now - debouce.lastCall < delay) {\r\n    window.clearTimeout(debouce.lastTimerId);\r\n  }\r\n\r\n  debouce.lastCall = now;\r\n  debouce.lastTimerId = window.setTimeout(() => {\r\n    cb();\r\n    debouce.lastCall = 0;\r\n    debouce.lastTimerId = null;\r\n  }, delay);\r\n};\r\n\r\nexport const saveToHash = obj => {\r\n  return (window.location.hash = stateToB64(obj));\r\n};\r\n\r\nexport const loadFromHash = maybeHash => {\r\n  let data = null;\r\n  try {\r\n    const hash = cleanHash(maybeHash || window.location.hash);\r\n    data = B64ToState(hash);\r\n  } catch (e) {\r\n    /* This can safely fail */\r\n  }\r\n\r\n  return data;\r\n};\r\n\r\nexport const cleanHash = hash => {\r\n  if (hash) {\r\n    if (hash.indexOf(\"/\")) {\r\n      hash = hash.split(\"/\").pop();\r\n    }\r\n    if (hash[0] === \"#\") {\r\n      hash = hash.substr(1);\r\n    }\r\n  }\r\n\r\n  return hash;\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tooltip\":\"tooltip_tooltip__1uHZI\",\"closeBtn\":\"tooltip_closeBtn__1LL9e\",\"table\":\"tooltip_table__ITSvF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tilesView\":\"cityViewer_tilesView__nDwhO\",\"tile\":\"cityViewer_tile__3vtyP\",\"tileBtn\":\"cityViewer_tileBtn__2uFFw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"header_header__v9FKw\",\"options\":\"header_options__2uQYe\"};","module.exports = __webpack_public_path__ + \"static/media/Ground.f403a60e.png\";","module.exports = __webpack_public_path__ + \"static/media/Grass.7170c6cd.png\";","module.exports = __webpack_public_path__ + \"static/media/Church.7bc8d6de.png\";","module.exports = __webpack_public_path__ + \"static/media/Pravda.e6952de9.png\";","module.exports = __webpack_public_path__ + \"static/media/milk_cooperation_small.f31462c0.png\";","module.exports = __webpack_public_path__ + \"static/media/milk_cooperation.972d65d7.png\";","import \"./Modal.css\";\r\nimport React, { useRef, useContext, useState, useEffect } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nconst Context = React.createContext();\r\n\r\nexport function ModalProvider({ children }) {\r\n  const modalRef = useRef();\r\n  const [context, setContext] = useState();\r\n\r\n  // make sure re-render is triggered after initial\r\n  // render so that modalRef exists\r\n  useEffect(() => {\r\n    setContext(modalRef.current);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"modal-container\">\r\n      <Context.Provider value={context}>{children}</Context.Provider>\r\n      <div ref={modalRef} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function Modal({ onClose, children, ...props }) {\r\n  const modalNode = useContext(Context);\r\n\r\n  return modalNode\r\n    ? ReactDOM.createPortal(\r\n        <div className=\"modal-overlay\" onClick={onClose}>\r\n          <div\r\n            className=\"modal-dialog\"\r\n            onClick={ev => ev.stopPropagation()}\r\n            {...props}\r\n          >\r\n            <div className=\"modal-head\">\r\n              <div className=\"modal-title\">{props.title || \"\"}</div>\r\n              <button className=\"modal-btn\" onClick={onClose}>\r\n                Close\r\n              </button>\r\n            </div>\r\n            <div className=\"modal-body\">{children}</div>\r\n          </div>\r\n        </div>,\r\n        modalNode\r\n      )\r\n    : null;\r\n}\r\n","import React, { useRef } from \"react\";\r\nimport { Modal } from \"components/common/Modal\";\r\n\r\nexport default function LoadModal({ setOpen, onLoadHash }) {\r\n  const loadInputRef = useRef();\r\n\r\n  const handleLoadHash = ev => onLoadHash(loadInputRef.current.value);\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Load...\"\r\n      onClose={() => setOpen(false)}\r\n      style={{ width: \"100%\", maxWidth: 420 }}\r\n    >\r\n      <p>Paste a city hash below to load a previous creation :</p>\r\n      <input type=\"text\" ref={loadInputRef} />\r\n      <button className=\"btn-clear\" onClick={handleLoadHash}>\r\n        Load\r\n      </button>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport LoadModal from 'components/modals/LoadModal';\r\nimport style from './header.module.css';\r\n\r\nexport default function Header({ onLoadHash, isEditMode, onEditHandler }) {\r\n  const [isModalOpen, setIsModalOpen] = useState(false);\r\n\r\n  return (\r\n    <header className={style.header}>\r\n      <div></div>\r\n      <div className={style.options}>\r\n        <button onClick={onEditHandler}>{isEditMode ? 'View' : 'Edit'}</button>\r\n      </div>\r\n\r\n      {isModalOpen && <LoadModal setOpen={setIsModalOpen} onLoadHash={onLoadHash} />}\r\n    </header>\r\n  );\r\n}\r\n","import './TilesLibrary.css';\r\nimport React from 'react';\r\nimport imgSrc1 from '../assets/Ground.png';\r\nimport imgSrc2 from '../assets/Grass.png';\r\nimport imgSrc3 from '../assets/Church.png';\r\nimport imgSrc4 from '../assets/Pravda.png';\r\nimport imgSrc6 from '../assets/milk_cooperation_small.png';\r\nimport imgSrc7 from '../assets/milk_cooperation.png';\r\n\r\nexport const arr = [\r\n  { url: imgSrc1 },\r\n  { url: imgSrc2 },\r\n  { url: imgSrc3 },\r\n  { url: imgSrc4 },\r\n  { url: imgSrc6 },\r\n  { url: imgSrc7 },\r\n];\r\n\r\nexport default function TilesLibrary({ selectedTile, onSelect }) {\r\n  return (\r\n    <div className='tiles-library'>\r\n      <div className='list'>\r\n        {arr.map(({ url }, i) => (\r\n          <div key={i} className={`tile ${selectedTile === i ? 'selected' : ''}`} onClick={() => onSelect(i)}>\r\n            <div\r\n              className='tile-img'\r\n              style={{\r\n                backgroundImage: `url(${url})`,\r\n              }}\r\n            />\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { loadFromHash } from \"./utils\";\r\n\r\nexport const constants = {\r\n  numTilesX: 12,\r\n  numTilesY: 6,\r\n  tileSizeX: 260,\r\n  tileSizeY: 460\r\n};\r\n\r\nexport const indexToTileXY = i => {\r\n  const tileX = i % constants.numTilesX;\r\n  const tileY = Math.floor(i / constants.numTilesX);\r\n  const x = tileX * constants.tileSizeX;\r\n  const y = tileY * constants.tileSizeY;\r\n\r\n  return { tileX, tileY, x, y };\r\n};\r\n\r\nexport const indexToBgPosition = i => {\r\n  const { tileX, tileY } = indexToTileXY(i);\r\n  return `${(tileX / (constants.numTilesX - 1)) * 100}% ${(tileY /\r\n    (constants.numTilesY - 1)) *\r\n    100}%`;\r\n};\r\n\r\nexport const tileToBgPosition = ({ x, y }) => {\r\n  return `${(x / constants.tileSizeX / (constants.numTilesX - 1)) * 100}% ${(y /\r\n    constants.tileSizeY /\r\n    (constants.numTilesY - 1)) *\r\n    100}%`;\r\n};\r\n\r\nexport const indexToPosition = (i, gridSize = 6) => {\r\n  const tileX = i % gridSize;\r\n  const tileY = Math.floor(i / gridSize);\r\n  return { tileX, tileY };\r\n};\r\n\r\nexport const positionToIndex = (tileX, tileY, gridSize = 6) =>\r\n  tileY * gridSize + tileX;\r\n\r\nexport const indexToViewPosition = (\r\n  i,\r\n  gridSize = 6,\r\n  offsetX = 0,\r\n  offsetY = 0\r\n) => {\r\n  const { tileX, tileY } = indexToPosition(i, gridSize);\r\n\r\n  return {\r\n    left: `${(tileX - tileY - 1) * 128 + offsetX}px`,\r\n    top: `${(tileX + tileY) * 73 + offsetY}px`\r\n  };\r\n};\r\n\r\nexport const updateGridSize = (oldGridSize, newGridSize, oldTiles) => {\r\n  // Save tiles along with their grid coordinates\r\n  const save = new Map();\r\n  oldTiles.forEach((tile, i) => {\r\n    const coords = indexToPosition(i, oldGridSize);\r\n    save.set(coords, tile);\r\n  });\r\n\r\n  // Create new empty board\r\n  const newTiles = createTiles(newGridSize, false);\r\n\r\n  // Restore saved tiles, getting their new index from their grid coordinates\r\n  save.forEach((tile, coords) => {\r\n    const newIdx = positionToIndex(coords.tileX, coords.tileY, newGridSize);\r\n    if (newIdx > -1 && newIdx < newTiles.length) {\r\n      newTiles[newIdx] = tile;\r\n    }\r\n  });\r\n\r\n  return newTiles;\r\n};\r\n\r\nexport const availableTiles = new Array(\r\n  constants.numTilesX * constants.numTilesY\r\n)\r\n  .fill(1)\r\n  .map((_, i) => indexToTileXY(i));\r\n\r\nexport const createTiles = (gridSize, randomize = true) =>\r\n  new Array(gridSize * gridSize)\r\n    .fill(0)\r\n    .map((_, i) => (randomize ? Math.floor(Math.random() * 72) : 0));\r\n\r\nexport const loadStateFromHash = (\r\n  baseGridSize = 6,\r\n  baseTiles = createTiles(baseGridSize),\r\n  maybeHash\r\n) => {\r\n  const data = loadFromHash(maybeHash);\r\n  if (\r\n    data &&\r\n    data.gridSize &&\r\n    typeof data.gridSize === \"number\" &&\r\n    data.tiles &&\r\n    data.tiles instanceof Array\r\n  ) {\r\n    baseGridSize = data.gridSize;\r\n    baseTiles = data.tiles;\r\n  }\r\n\r\n  return {\r\n    gridSize: baseGridSize,\r\n    tiles: baseTiles\r\n  };\r\n};\r\n","import './cityBuilder.css';\r\nimport React from 'react';\r\nimport { indexToViewPosition } from 'providers/TilesService';\r\nimport { arr } from '../TilesLibrary';\r\n\r\nconst getTileIdxFromBtnEvent = (ev) =>\r\n  ev.target.hasAttribute('data-tile-idx') ? Number(ev.target.getAttribute('data-tile-idx')) : -1;\r\n\r\nexport default function TilesView({\r\n  tiles,\r\n  onLeftClick,\r\n  onRightClick,\r\n  gridSize = 6,\r\n  offsetX = 130 * gridSize,\r\n  offsetY = -300,\r\n  selectedTile,\r\n}) {\r\n  const handleClick = (ev) => {\r\n    const i = getTileIdxFromBtnEvent(ev);\r\n    if (i > -1) {\r\n      ev.preventDefault();\r\n      ev.stopPropagation();\r\n      if (ev.buttons === 1) {\r\n        onLeftClick(i);\r\n      } else if (ev.buttons === 2) {\r\n        onRightClick(i);\r\n      }\r\n    }\r\n  };\r\n  const handleMouseMove = (ev) => {\r\n    if (ev.buttons) {\r\n      handleClick(ev);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className='tiles-view' onMouseMove={handleMouseMove}>\r\n      {tiles.map((tile, i) => {\r\n        const { top, left } = indexToViewPosition(i, gridSize, offsetX, offsetY);\r\n\r\n        return (\r\n          <div\r\n            key={i}\r\n            className='tile'\r\n            style={{\r\n              backgroundImage: `url(${arr[tile].url})`,\r\n              top,\r\n              left,\r\n              '--hover-image': `url(${arr[selectedTile].url})`,\r\n            }}\r\n          >\r\n            <div className='tile-btn' data-tile-idx={i} onMouseDown={handleClick} />\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\nimport style from \"./tooltip.module.css\";\n\nconst data = [\n  { title: \"Personal\", value: 20 },\n  { title: \"Total income\", value: \"20000UAH\" },\n];\n\nconst Tooltip = ({ onClose }) => {\n  return (\n    <div className={style.tooltip}>\n      <button className={style.closeBtn} onClick={onClose}>\n        x\n      </button>\n      <h3>Pravda</h3>\n      <div className={style.table}>\n        {data.map(({ title, value }) => {\n          return (\n            <>\n              <span>{title}</span>\n              <span>{value}</span>\n            </>\n            // <div className={style.row}>\n            // </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default Tooltip;\n","import React, { useState } from 'react';\r\nimport { indexToViewPosition } from 'providers/TilesService';\r\nimport { arr } from '../TilesLibrary';\r\nimport Tooltip from './tooltip/Tooltip';\r\nimport style from './cityViewer.module.css';\r\n\r\nconst getTileIdxFromBtnEvent = (ev) =>\r\n  ev.target.hasAttribute('data-tile-idx') ? Number(ev.target.getAttribute('data-tile-idx')) : -1;\r\n\r\nexport default function CityViewer({\r\n  tiles,\r\n  // onLeftClick,\r\n  // onRightClick,\r\n  gridSize = 6,\r\n  offsetX = 150 * gridSize,\r\n  offsetY = -300,\r\n}) {\r\n  const [selected, setSelected] = useState(null);\r\n\r\n  const onClick = (i) => {\r\n    setSelected(i);\r\n  };\r\n\r\n  const handleClick = (ev) => {\r\n    const i = getTileIdxFromBtnEvent(ev);\r\n    if (i > -1) {\r\n      ev.preventDefault();\r\n      ev.stopPropagation();\r\n\r\n      if (ev.buttons === 1) {\r\n        // onLeftClick(i);\r\n        onClick(i);\r\n      } else if (ev.buttons === 2) {\r\n        // onRightClick(i);\r\n      }\r\n    }\r\n  };\r\n\r\n  const closeHandler = () => {\r\n    setSelected(null);\r\n  };\r\n\r\n  return (\r\n    <div className={style.tilesView}>\r\n      {tiles.map((tile, i) => {\r\n        const { top, left } = indexToViewPosition(i, gridSize, offsetX, offsetY);\r\n        return (\r\n          <div\r\n            key={i}\r\n            className={style.tile}\r\n            style={{\r\n              backgroundImage: `url(${arr[tile].url})`,\r\n              top,\r\n              left,\r\n\r\n              '--hover-image': `url(${arr[tile].url})`,\r\n            }}\r\n          >\r\n            {selected === i && <Tooltip onClose={closeHandler} />}\r\n\r\n            <div className={style.tileBtn} data-tile-idx={i} onMouseDown={handleClick}></div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import \"./TilesBuilder.css\";\nimport React, { useState, useEffect } from \"react\";\nimport Header from \"components/header/Header\";\nimport TilesLibrary from \"components/TilesLibrary\";\nimport CityBuilder from \"components/cityBuilder/CityBuilder\";\nimport CityViewer from \"components/cityViewer/CityViewer\";\nimport {\n  createTiles,\n  updateGridSize,\n  loadStateFromHash,\n} from \"providers/TilesService\";\nimport { debouce, saveToHash } from \"providers/utils\";\n\nlet lastHash = \"\";\n\nconst baseTiles = [\n  3, 0, 0, 2, 0, 2, 0, 5, 0, 0, 3, 0, 3, 0, 5, 3, 0, 3, 0, 4, 2, 0, 0, 0, 5, 4,\n  0, 0, 0, 5, 3, 0, 4, 0, 0, 4,\n];\n\nexport default function TilesBuilder() {\n  const [gridSize, setGridSize] = useState(6);\n  const [tiles, setTiles] = useState(baseTiles);\n  const [selectedTile, setSelectedTile] = useState(0);\n  const [isEditMode, setIsEditMode] = useState(true);\n\n  useEffect(() => {\n    window.addEventListener(\"hashchange\", onHashChange);\n    return () => window.removeEventListener(\"hashchange\", onHashChange);\n  });\n\n  /**\n   * Utils\n   */\n  const updateHash = (delay = 500) =>\n    debouce(() => {\n      lastHash = saveToHash({ gridSize, tiles });\n    }, delay);\n  const onHashChange = (ev) => {\n    const newHash = new URL(ev.newURL).hash.substr(1);\n    if (lastHash !== newHash) {\n      lastHash = newHash;\n      handleLoadHash(newHash, false);\n    }\n  };\n  /**\n   * Header handlers\n   */\n  const handleLoadHash = (hash, doUpdate = true) => {\n    const { gridSize: newGridSize, tiles: newTiles } = loadStateFromHash(\n      gridSize,\n      tiles,\n      hash\n    );\n\n    // Update state\n    setGridSize(newGridSize);\n    setTiles(newTiles);\n    if (doUpdate) {\n      updateHash(0);\n    }\n  };\n  const handleGridSizeChange = (ev) => {\n    const newValue = Number(ev.target.value);\n    const newTiles = updateGridSize(gridSize, newValue, tiles);\n\n    // Update state\n    setGridSize(newValue);\n    setTiles(newTiles);\n    updateHash();\n  };\n  const randomize = () => {\n    setTiles(createTiles(gridSize));\n    updateHash(0);\n  };\n  const clear = () => {\n    setTiles(createTiles(gridSize, false));\n    updateHash(0);\n  };\n\n  /**\n   * Library handlers\n   */\n  const handleSelect = (newSelection) => {\n    if (newSelection !== selectedTile) {\n      setSelectedTile(newSelection);\n    }\n  };\n\n  /**\n   * View Handlers\n   */\n  const setTile = (tileIdx, tileType) => {\n    const newTiles = [...tiles];\n    newTiles[tileIdx] = tileType;\n    setTiles(newTiles);\n\n    updateHash();\n  };\n  const leftClick = (tileIdx) => setTile(tileIdx, selectedTile);\n  const rightClick = (tileIdx) => setTile(tileIdx, 0);\n\n  const editHandler = () => {\n    setIsEditMode((prev) => !prev);\n  };\n\n  return (\n    <div className=\"tiles-builder\">\n      <Header\n        gridSize={gridSize}\n        onLoadHash={handleLoadHash}\n        onGridSizeChange={handleGridSizeChange}\n        onRandomize={randomize}\n        onClear={clear}\n        isEditMode={isEditMode}\n        onEditHandler={editHandler}\n      />\n\n      {isEditMode && (\n        <TilesLibrary selectedTile={selectedTile} onSelect={handleSelect} />\n      )}\n\n      {isEditMode ? (\n        <CityBuilder\n          tiles={tiles}\n          gridSize={gridSize}\n          onLeftClick={leftClick}\n          onRightClick={rightClick}\n          selectedTile={selectedTile}\n        />\n      ) : (\n        <CityViewer\n          tiles={tiles}\n          gridSize={gridSize}\n          onLeftClick={leftClick}\n          onRightClick={rightClick}\n        />\n      )}\n    </div>\n  );\n}\n","import React from \"react\";\nimport TilesBuilder from \"components/TilesBuilder\";\nimport { ModalProvider } from \"components/common/Modal\";\nimport \"./styles.css\";\n\nexport default function App() {\n  return (\n    <div className=\"App\">\n      <ModalProvider>\n        <TilesBuilder />\n      </ModalProvider>\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App />, rootElement);\n"],"sourceRoot":""}