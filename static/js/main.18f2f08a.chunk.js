(this["webpackJsonpcity-builder"]=this["webpackJsonpcity-builder"]||[]).push([[0],[,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return o}));const a=(e,t)=>{const n=performance.now();a.lastCall&&n-a.lastCall<t&&window.clearTimeout(a.lastTimerId),a.lastCall=n,a.lastTimerId=window.setTimeout(()=>{e(),a.lastCall=0,a.lastTimerId=null},t)},l=t=>window.location.hash=(t=>e.from(JSON.stringify(t)).toString("base64"))(t),o=t=>{let n=null;try{const l=i(t||window.location.hash);a=l,n=JSON.parse(e.from(a,"base64"))}catch(l){}var a;return n},i=e=>(e&&(e.indexOf("/")&&(e=e.split("/").pop()),"#"===e[0]&&(e=e.substr(1))),e)}).call(this,n(14).Buffer)},,,function(e,t,n){e.exports=n(20)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),o=n(2),i=n.n(o);n(9),n(10),n(11),n(12);const r=l.a.createContext();function c(e){let{children:t}=e;const n=Object(a.useRef)(),[o,i]=Object(a.useState)();return Object(a.useEffect)(()=>{i(n.current)},[]),l.a.createElement("div",{className:"modal-container"},l.a.createElement(r.Provider,{value:o},t),l.a.createElement("div",{ref:n}))}function s(e){let{onClose:t,children:n,...o}=e;const c=Object(a.useContext)(r);return c?i.a.createPortal(l.a.createElement("div",{className:"modal-overlay",onClick:t},l.a.createElement("div",Object.assign({className:"modal-dialog",onClick:e=>e.stopPropagation()},o),l.a.createElement("div",{className:"modal-head"},l.a.createElement("div",{className:"modal-title"},o.title||""),l.a.createElement("button",{className:"modal-btn",onClick:t},"Close")),l.a.createElement("div",{className:"modal-body"},n))),c):null}function u(e){let{setOpen:t,onLoadHash:n}=e;const o=Object(a.useRef)();return l.a.createElement(s,{title:"Load...",onClose:()=>t(!1),style:{width:"100%",maxWidth:420}},l.a.createElement("p",null,"Paste a city hash below to load a previous creation :"),l.a.createElement("input",{type:"text",ref:o}),l.a.createElement("button",{className:"btn-clear",onClick:e=>n(o.current.value)},"Load"))}function d(e){let{setOpen:t}=e;return l.a.createElement(s,{title:"About",onClose:()=>t(!1),style:{width:400}},l.a.createElement("h1",null,"IsoCity Builder"),l.a.createElement("p",null,"Simple isometric city builder."),l.a.createElement("p",null,"Inspired from\xa0",l.a.createElement("a",{href:"https://victorribeiro.com/isocity",rel:"nofollow"},"https://victorribeiro.com/isocity"),"."),l.a.createElement("p",null,"Edit on\xa0",l.a.createElement("a",{href:"https://codesandbox.io/s/city-builder-kgghx",rel:"nofollow"},"CodeSandbox"),"."),l.a.createElement("p",null,"Created with React."),l.a.createElement("h2",null,"Tips"),l.a.createElement("ul",null,l.a.createElement("li",null,"Share your creations by sharing your page URL, it is changing as you build"),l.a.createElement("li",null,"You can undo/redo using your browser back/forward functions")))}function m(e){let{gridSize:t,onGridSizeChange:n,onRandomize:o,onClear:i,onLoadHash:r}=e;const[c,s]=Object(a.useState)(!1),[m,f]=Object(a.useState)(!1);return l.a.createElement("header",null,l.a.createElement("div",null,l.a.createElement("span",{className:"title"},"IsoCity Builder"),l.a.createElement("button",{onClick:()=>s(!0)},"Load..."),l.a.createElement("button",{onClick:()=>f(!0)},"About")),l.a.createElement("div",{className:"options"},l.a.createElement("label",{htmlFor:"gridsize-input"},"Grid Size: ",t),"\xa0",l.a.createElement("input",{id:"gridsize-input",type:"range",min:"1",max:"16",defaultValue:t,onChange:n}),l.a.createElement("button",{onClick:o},"Randomize"),l.a.createElement("button",{onClick:i},"Clear")),c&&l.a.createElement(u,{setOpen:s,onLoadHash:r}),m&&l.a.createElement(d,{setOpen:f}))}n(13);var f=n(1);const h=12,b=6,E=130,g=230,p=e=>{const t=e%h,n=Math.floor(e/h);return{tileX:t,tileY:n,x:t*E,y:n*g}},v=e=>{const{tileX:t,tileY:n}=p(e);return"".concat(t/(h-1)*100,"% ").concat(n/(b-1)*100,"%")},y=e=>{let{x:t,y:n}=e;return"".concat(t/E/(h-1)*100,"% ").concat(n/g/(b-1)*100,"%")},C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const n=e%t,a=Math.floor(e/t);return{tileX:n,tileY:a}},w=new Array(h*b).fill(1).map((e,t)=>p(t)),S=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Array(e*e).fill(0).map((e,n)=>t?Math.floor(72*Math.random()):0)},N=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S(e),n=arguments.length>2?arguments[2]:void 0;const a=Object(f.b)(n);return a&&a.gridSize&&"number"===typeof a.gridSize&&a.tiles&&a.tiles instanceof Array&&(e=a.gridSize,t=a.tiles),{gridSize:e,tiles:t}};function O(e){let{selectedTile:t,onSelect:n}=e;return l.a.createElement("div",{className:"tiles-library"},l.a.createElement("h1",null,"library"),w.map((e,a)=>l.a.createElement("div",{key:a,className:"tile ".concat(t===a?"selected":""),onClick:()=>n(a)},l.a.createElement("div",{className:"tile-img",style:{backgroundPosition:y(e)}}))))}n(19);function k(e){let{tiles:t,onLeftClick:n,onRightClick:a,gridSize:o=6,offsetX:i=64*o,offsetY:r=0}=e;const c=e=>{const t=(e=>e.target.hasAttribute("data-tile-idx")?Number(e.target.getAttribute("data-tile-idx")):-1)(e);t>-1&&(e.preventDefault(),e.stopPropagation(),1===e.buttons?n(t):2===e.buttons&&a(t))};return l.a.createElement("div",{className:"tiles-view",onMouseMove:e=>{e.buttons&&c(e)}},t.map((e,t)=>{const{top:n,left:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const{tileX:l,tileY:o}=C(e,t);return{left:"".concat(64*(l-o-1)+n,"px"),top:"".concat(32*(l+o)+a,"px")}}(t,o,i,r);return l.a.createElement("div",{key:t,className:"tile",style:{backgroundPosition:v(e),top:n,left:a}},l.a.createElement("div",{className:"tile-btn","data-tile-idx":t,onMouseDown:c}))}))}const{gridSize:z,tiles:x}=N(6);let j="";function L(){const[e,t]=Object(a.useState)(z),[n,o]=Object(a.useState)(x),[i,r]=Object(a.useState)(0);Object(a.useEffect)(()=>(window.addEventListener("hashchange",s),()=>window.removeEventListener("hashchange",s)));const c=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;return Object(f.a)(()=>{j=Object(f.c)({gridSize:e,tiles:n})},t)},s=e=>{const t=new URL(e.newURL).hash.substr(1);j!==t&&(j=t,u(t,!1))},u=function(a){let l=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{gridSize:i,tiles:r}=N(e,n,a);t(i),o(r),l&&c(0)},d=(e,t)=>{const a=[...n];a[e]=t,o(a),c()};return l.a.createElement("div",{className:"tiles-builder"},l.a.createElement(m,{gridSize:e,onLoadHash:u,onGridSizeChange:a=>{const l=Number(a.target.value),i=((e,t,n)=>{const a=new Map;n.forEach((t,n)=>{const l=C(n,e);a.set(l,t)});const l=S(t,!1);return a.forEach((e,n)=>{const a=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return t*n+e}(n.tileX,n.tileY,t);a>-1&&a<l.length&&(l[a]=e)}),l})(e,l,n);t(l),o(i),c()},onRandomize:()=>{o(S(e)),c(0)},onClear:()=>{o(S(e,!1)),c(0)}}),l.a.createElement(O,{selectedTile:i,onSelect:e=>{e!==i&&r(e)}}),l.a.createElement(k,{tiles:n,gridSize:e,onLeftClick:e=>d(e,i),onRightClick:e=>d(e,0)}))}function R(){return l.a.createElement("div",{className:"App"},l.a.createElement(c,null,l.a.createElement(L,null)))}const A=document.getElementById("root");i.a.render(l.a.createElement(R,null),A)}],[[4,1,2]]]);
//# sourceMappingURL=main.18f2f08a.chunk.js.map